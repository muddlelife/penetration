# 信息收集

信息收集工作，找出目标的漏洞和弱点，然后利用这些漏洞和弱点进行攻击

## 信息收集分类

### 主动信息收集

可获得的信息较多，但易被目标发现

### 被动信息收集

搜集到的信息较少，但不易被发现

## 信息收集内容

* 域名

  * 在线whois查询
  * 在线网站备案查询
  * 天眼查——知识产权——股权穿透图——子公司——收集邮箱钓鱼——手机号查名字

* 子域名

  * oneforall

* 真实IP

  * 绕CDN
  * 邮件原文
  * 查询历史DNS记录相关查询网站

* 旁站、C段

  * 旁站：同服务器其他站点
  * C段：同一网段其他服务器

* 端口扫描

  * nmap，确定真实ip后，最好在扫C段

  * nmap -sS -v -sV -p 1-65535 IP  # ping目标有回复时

  * nmap -sS -v -sV -p 1-65535 -Pn IP  # ping目标没有回复时

  * 一般都在VPS扫

    | 文件共享服务端口 |         服务         |
    | :--------------: | :------------------: |
    |     139、445     |     文件共享服务     |
    |       2049       |       NFS服务        |
    |     21/22/69     | FTP/TFTP文件传输协议 |

    | 远程连接端口服务 |                   攻击手段                    |
    | :--------------: | :-------------------------------------------: |
    |        22        |     爆破、SSH隧道及内网代理转发，文件传输     |
    |        23        |              爆破、嗅探、弱口令               |
    |       3389       | Shift后门（需要Windows 2003以下的系统）、爆破 |
    |       5900       |                  弱口令爆破                   |

    | Web应用服务端口 |                           攻击手段                           |
    | :-------------: | :----------------------------------------------------------: |
    |     80/443      |              Web攻击、爆破、对应服务器版本漏洞               |
    |    7001/7002    |         Java反序列化、弱口令、特定版本SSRF、未授权等         |
    |      8080       | tomcat：控制台弱口令、幽灵猫、任意文件上传、远程代码执行；Jboss；未授权、反序列化；检测工具：https://github.com/joaomatosf/jexboss |
    |      2375       |                  未授权方式、容器逃逸、提权                  |

    |       数据库服务端口       |                          攻击手段                          |
    | :------------------------: | :--------------------------------------------------------: |
    |            3306            |                      注入、提权、爆破                      |
    |            1433            |                 注入、提权、SA弱口令、爆破                 |
    |            1521            |                      注入、反弹shell                       |
    | 27017、27018、27019、28017 |                      爆破、未授权访问                      |
    |            6379            | 未授权访问、弱口令爆破、公私钥、反弹shell、绝对路径写shell |

* 扫描敏感目录/文件

  * 后台目录、数据库配置文件、安装文件、phpinfo文件、编辑器目录、robots.txt、备份文件、信息泄露、git文件、GitHub上代码泄露

* 指纹识别

* 网络空间搜索引擎

  * shodan、fofa、Google hacking

  ```shell
  # Google
  # 查找后台地址： site:域名
  inurl:login|admin|manage|member|adminlogin|loginadmin|system|login|user|main|cms
  # 查找文本内容： site:域名 intext:管理|后台|登录|用户名|密码|验证码|系统|账号
  |admin|login|sys|managetem|password|username
  # 查找可注入点： site:域名 inurl:aspx|jsp|php|asp
  # 查找上传漏洞： site:域名 inurl:file|load|editor|Files 找eweb
  # 编辑器： site:域名 inurl:ewebeditor|editor|uploadfile|eweb|edit
  # 存在的数据库： site:域名 filetype:mdb|asp|#
  # 查看脚本类型： site:域名 filetype:asp/aspx/php/jsp
  # fofa
  title="目标名称" && region="xx省"
  title="目标名称" && city="xx市"
  cert="目标域名或者证书关键字" && region="xx省"
  title="目标域名或者证书关键字" && city="xx市"
  ((title="目标名称" || host="目标域名") && country="CN"
  ```

  